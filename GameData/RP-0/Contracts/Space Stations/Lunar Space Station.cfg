CONTRACT_TYPE
{
	name = MoonSpaceStation
	title = Lunar Space Station
	group = SpaceStations
	agent = Stations

	description = You have successfully survived in a Space Station in Earth Orbit, and have gathered some valuable data from it too. Now it is time for you to go further beyond. Design, build, and launch a space station into orbit of the Moon, then crew it for a month with at least two crew, and bring the crew safely home. Once you're done, you'll get missions that utilize the station for Lunar Landings.

	synopsis = Launch a Space Station into Lunar Orbit and crew it for a month

	completedMessage = Congratulations! Your space station is now in orbit around the Moon and the first crew has put it through the shake-out process.

	sortKey = 1520

	cancellable = true
	declinable = false
	autoAccept = false
	minExpiry = 0
	maxExpiry = 0
	maxCompletions = 1
	maxSimultaneous = 1
	deadline = 1095 * RP1DeadlineMult()  // 3 years

	targetBody = Moon



	prestige = Exceptional   // 1.5x
	advanceFunds = 0.625 * 200000 * @RP0:globalHardContractMultiplier //1.8 mil
	rewardScience = 0
	rewardReputation = 500
	rewardFunds = 0.625 * 100000 * @RP0:globalHardContractMultiplier //900k 
	failureReputation = 750
	failureFunds = @advanceFunds * 0.5

	// ************ REQUIREMENTS ************

	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = first_ISScrew
		minCount = 2
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = SingleCrewedLunarOrbitRepeatable
	}

	// ************ PARAMETERS ************

	PARAMETER
	{
		name = vesselGroupLaunch
		type = VesselParameterGroup
		title = Put a Space Station into Lunar Orbit
		notes = The station must include at least 1 Docking Port and support for at least 4 Crew
		define = spaceStationMoon
		defineList = spaceStationsMoon

		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = Launch a New Station
			hideChildren = true
		}
		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 4
			title = Space for at least 4 crew
			hideChildren = true
		}
		PARAMETER
		{
			name = DockingPort
			type = PartValidation
			partModule = ModuleDockingNode
			minCount = 1
			title = Have at least 1 Docking Ports
			hideChildren = true
		}
		PARAMETER
		{
			name = HasPower
			title = Can Generate Power
			type = Any
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar panel
				hideChildren = true
			}
		}
		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 100000
			maxApA = 1000000
			targetBody = Moon
			title = Reach Orbit with a Periselene greater than 100 km and an Aposelene less than 1,000 km
			hideChildren = true
		}
		PARAMETER
		{
			name = CapsuleType
			type = VesselIsType
			vesselType = Station
			title = Must be a Station
			hideChildren = true
		}
		
		disableOnStateChange = true
	}
	PARAMETER
	{
		name = vesselGroupCrew
		type = VesselParameterGroup
		title = Bring at least 3 crew to the station
		define = crewCapsuleMoon

		completeInSequence = true

		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = Rendezvous
			type = RP1Rendezvous
			vessel = spaceStationMoon
			distance = 100
			relativeSpeed = 0.5
		}
	}
	PARAMETER
	{
		name = stayOnStation
		type = VesselParameterGroup
		title = Keep at least 3 crew aboard the station for 30 days.
		vessel = spaceStationMoon

		completeInSequence = true

		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 100000
			maxApA = 1000000
			targetBody = Moon
			title = Remain in a Stable Orbit
			hideChildren = true
		}
		PARAMETER
		{
			name = Duration
			type = Duration
			duration =  30d
			preWaitText = Transfer to the station in the specified orbit.
			waitingText = Orbiting...
			completionText = Stay completed, you may return home now.
		}
	}
	PARAMETER
	{
		name = vesselGroupCrewReturn
		type = VesselParameterGroup
		title = Return the crew home
		vessel = crewCapsuleMoon

		completeInSequence = true

		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = ReturnHome
			type = ReturnHome
			targetBody = HomeWorld()
			title = Return Home Safely
			hideChildren = true
			completeInSequence = true
		}
	}
	PARAMETER
	{
		name = vesselGroupStationPersist
		type = VesselParameterGroup
		title = Keep the station in orbit
		vessel = spaceStationMoon

		completeInSequence = true

		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 100000
			maxApA = 1000000
			targetBody = Moon
			title = Remain in a Stable Orbit
			hideChildren = true
		}
	}
}

CONTRACT_TYPE
{
	name = MoonSpaceStationLanding
	title = Crewed Moon Landing and Lunar Space Station
	group = SpaceStations
	agent = Stations
	
	description = You have successfully launched your Lunar Space Station and tested it for survivability. Now, it is time for you to utilize your new habitat.  Design, build, and launch a lunar lander and crew capsule to rendezvous with the space station, crew the station for a week, then land on the moon, return back to the station, then return home. 
	
	synopsis = Do a Lunar Landing while utilizing your Lunar Space Station.
	
	completedMessage = Congratulations, you've successfully done a lunar landing while utilizing your Lunar Space Station.
	
	sortKey = 1521
	
	cancellable = true
	declinable = false
	autoAccept = false
	minExpiry = 0
	maxExpiry = 0
	maxCompletions = 2
	maxSimultaneous = 1
	deadline = 1825 * RP1DeadlineMult()  // 5 years

	targetBody = Moon
	
	
	
	prestige = Exceptional   // 1.5x
	advanceFunds = 0.625 * 111111.1111 * @RP0:globalHardContractMultiplier //1 mil.
	rewardScience = 0
	rewardReputation = 250
	rewardFunds =  @advanceFunds 
	failureReputation = 250
	failureFunds = @advanceFunds * 0.5
	
	// ************ REQUIREMENTS ************
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = first_MoonLandingCrewed
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MoonSpaceStation
	}
	
	// ************ PARAMETERS ************
	
	PARAMETER
	{
		name = vesselLanderLaunch
		type = VesselParameterGroup
		title = Rendezvous a lander with the space station.
		define = moonStationLander
		
		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = Launch an Uncrewed Lunar Lander.
			hideChildren = true
		}
		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 2
			title = Space for at least 2 crew
			hideChildren = true
		}
		
		PARAMETER
		{
			name = Rendezvous
			type = RP1Rendezvous
			vessel = spaceStationMoon
			distance = 100
			relativeSpeed = 0.5
		}
	}
	
	PARAMETER
	{
		name = vesselGroupCrew
		type = VesselParameterGroup
		title = Bring at least 3 crew to the station.
		define = moonStationCapsule
		
		completeInSequence = true
		
		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = Launch an Uncrewed Lunar Lander.
			hideChildren = true
		}
		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board.
			hideChildren = true
		}
		PARAMETER
		{
			name = Rendezvous
			type = RP1Rendezvous
			vessel = spaceStationMoon
			distance = 100
			relativeSpeed = 0.5
		}
	}
	
	PARAMETER
	{
		name = stayOnStation
		type = VesselParameterGroup
		title = Keep your crew on the station for 2 weeks
		vessel = improvedSpaceStation
		
		completeInSequence = true
		
		PARAMETER
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 100000
			maxApA = 1000000
			targetBody = Moon
			title = Reach Orbit with a Periselene greater than 100 km and an Aposelene less than 1,000 km
			hideChildren = true
			
			PARAMETER
			{
				name = Duration
				type = Duration
				duration =  14d
				preWaitText = Transfer to the station in the specified orbit.
				waitingText = Orbiting...
				completionText = Stay completed. Time to land on the moon.
			}
		}
	}
	
	PARAMETER
	{
		name = landOnMoon
		type = VesselParameterGroup
		title = Land on the moon for a day then return back to the station.
		vessel = moonStationLander
		
		completeInSequence = true

		PARAMETER
		{
			name = TwoCrew
			type = HasCrew
			minCrew = 1
			maxCrew = 99
			title = Have at least 1 crewmember on board
			hideChildren = true
		}
		PARAMETER
		{
			name = LandOnMoon
			type = ReachState
			targetBody = Moon
			situation = LANDED
			disableOnStateChange = true
			title = Land on the Moon
			hideChildren = true
		}
		PARAMETER
		{
			name = Rendezvous
			type = RP1Rendezvous
			vessel = spaceStationMoon
			distance = 100
			relativeSpeed = 0.5
			completeInSequence = true
		}
	}
	
	PARAMETER
	{
		name = returnHome
		type = VesselParameterGroup
		title = Return home.
		vessel = moonStationLander
		
		completeInSequence = true
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 3
			title = Have at least 3 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = ReturnHome
			type = ReturnHome
			targetBody = HomeWorld()
			title = Return Home Safely
			hideChildren = true
			completeInSequence = true
		}
	}
	
}