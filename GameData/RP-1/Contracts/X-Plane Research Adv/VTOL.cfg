CONTRACT_TYPE
{
	name = AdvXPlanesVTOL
	group = AdvXPlanes

	title = Advanced X-Planes (Vertical Takeoff and Landing)
	
	tag = exclude_Supersonic

	description = <b>Program: Advanced X-Plane Research<br>Type: <color=red>CAPSTONE</color></b><br><br>Design, build, and fly a crewed jet aircraft capable of taking off with a horizontal velocity less than 10m/s then fly it with a horizontal velocity between 150 m/s and 300 m/s in level flight. Lastly, land it vertically under power. Optionally, landing back at the runway will award extra reputation. If playing from the Cape, the Space Shuttle runway provided by the RSS-CanaveralHD mod is also a valid landing target.<br><br><color=white><b></b></color>
	genericDescription = Design, build, and fly a crewed jet aircraft capable of vertical flight and horizontal crusie, then return home safely.
	
	synopsis = Fly a crewed non-rocket aircraft capable of vertical takeoff with a horizontal velocity less than 25m/s, then land vertically.

	completedMessage = Congratulations on a successful flight!
	
	sortKey = 4504

	deadline = 0
	cancellable = true
	declinable = true
	autoAccept = false
	minExpiry = 1
	maxExpiry = 1

	targetBody = HomeWorld()

	maxCompletions = 1
	maxSimultaneous = 1
	prestige = Trivial

	// ************ REWARDS ************
	prestige = Trivial       // 1.0x
	advanceFunds = 0
	rewardScience = 0
	rewardFunds = 0
	failureFunds = 0
	rewardReputation = 25
	failureReputation = 0 // was @rewardReputation
	
	// ************* REQUIREMENTS ****************

	REQUIREMENT
	{
		name = ProgramActive
		type = ProgramActive
		program = AdvXPlanes
	}

	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		minCount = 1
		contractType = AdvXPlanesSTOL
	}
	
	REQUIREMENT
	{
		name = AcceptContract
		type = AcceptContract
		tag = exclude_Supersonic
		invertRequirement = true
	}

	PARAMETER
	{
		name = VesselGroup
		type = VesselParameterGroup
		title = Maintain between @HoldSituation/minSpeed m/s and @HoldSituation/maxSpeed m/s in level flight with a crewed jet aircraft.
		define = supersonicCraft
		dissassociateVesselsOnContractCompletion = true
		resetChildrenWhenVesselDestroyed = true
		
		PARAMETER
		{
			name = BuiltAtSPH
			type = VesselBuiltAt
			builtAt = SPH
		}

		PARAMETER
		{
			name = Has Crew
			type = HasCrew
			minCrew = 1
			crewOnly = true
			title = Have at least 1 crewmember on board
			hideChildren = true
		}

		PARAMETER
		{
			name = NoRocket
			type = PartValidation
			title = Vessel is a jet (no rocket engines allowed)
			hideChildren = true
			NONE
			{
				partModule = ModuleEnginesRF
			}
		}
		
		PARAMETER
		{
			name = NoChutes
			type = PartValidation
			title = Vessel has no parachutes.
			hideChildren = true
			NONE
			{
				partModule = RealChuteModule
			}
		}

		
		PARAMETER
		{
			name = HoldSituation
			type = ReachState
			minSpeed = 0
			maxSpeed = 10
			minRateOfClimb = 5
			maxRateOfClimb = 150
			maxAltitudeKm = 1
			situation = FLYING
			
			title = Hold between @minSpeed m/s to @maxSpeed m/s while ascending.
			
			disableOnStateChange = true
			
			PARAMETER
			{
				name = Duration
				type = Duration
				duration = 0.25m
				preWaitText = Reach specified speed.
				waitingText = Testing vertical takeoff
				completionText = Flight completed, you are cleared to land.
			}
		}
		
		PARAMETER
		{
			name = HoldSituation
			type = ReachState
			minSpeed = 150
			maxSpeed = 300
			minRateOfClimb = -10
			maxRateOfClimb = 10
			situation = FLYING
			
			title = Hold between @minSpeed m/s to @maxSpeed m/s in level flight.
			
			disableOnStateChange = true
			
			PARAMETER
			{
				name = Duration
				type = Duration
				duration = 5m
				preWaitText = Reach specified speed.
				waitingText = Testing vertical takeoff
				completionText = Flight completed, you are cleared to land.
			}
		}
	}

	PARAMETER
	{
		name = ReturnVesselGroup
		type = VesselParameterGroup
		title = Land/splashdown anywhere
		vessel = supersonicCraft
		hideChildren = true

		PARAMETER
		{
			name = ReturnHome
			type = RP1ReturnHome
			title = Return home safely
			maxSpeed = 5
			hideChildren = true
			completeInSequence = true
		}
	}

	PARAMETER
	{
		name = OptVesselGroup
		type = VesselParameterGroup
		title = OPTIONAL: Land on the runway with a descent angle lower than 10 degrees
		rewardReputation = Round(@/rewardReputation * 0.3 + 0.4999, 1)
		optional = true
		vessel = supersonicCraft
		hideChildren = true

		PARAMETER
		{
			name = HorizontalLanding //FIXME potentially if the veritcal landing part doesnt work.
			type = HorizontalLanding
			descentAngle = 90
			hideChildren = true
			completeInSequence = true
		}

		PARAMETER
		{
			name = ReturnHome
			type = RP1ReturnHome
			landAtFacility = Runway
			maxSpeed = 5
			hideChildren = true
			completeInSequence = true
		}
	}
}
