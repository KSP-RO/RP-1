CONTRACT_TYPE
{
	name = modular_SpaceStation
	title = Modular Space Station
	group = SpaceStations
	agent = Stations
	
	description = Design, build, and launch space station modules into Earth orbit and dock them, then crew it for a month with at least five crew, and bring the crew safely home. The required modules include a Crew module, a Docking module, a Life Support Storage module, Power producing module, and a Science module. Once you're done, you'll get missions to perform further crew rotations and resupply missions, as well as expansion or replacement missions.
	
	synopsis = Launch a Modular Space Station into Earth Orbit.
	
	completedMessage = Congratulations! You have successfully launched the first modular space station into orbit. 
	
	sortKey = 1513
	
	cancellable = true
	declinable = false
	autoAccept = false
	minExpiry = 0
	maxExpiry = 0
	maxCompletions = 1
	maxSimultaneous = 1
	deadline = 3650 * RP1DeadlineMult() //10 years
	
	targetBody = HomeWorld()
	
	prestige = Exceptional   // 1.5x
	advanceFunds = 555555.5555 * @RP0:globalHardContractMultiplier
	rewardScience = 0
	rewardReputation = 500
	rewardFunds = 833333.3333 * @RP0:globalHardContractMultiplier
	failureReputation = 750
	failureFunds = @advanceFunds * 0.5
	
	// ************ REQUIREMENTS ************
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = first_ISScrew
		minCount = 2
	}
	REQUIREMENT
	{
		name = HasStationScience
		type = TechResearched
		tech = sampleReturnScience
	}
	DATA
	{
		type = string
		craft = "modularSpaceStation"
		hidden = true
	}
	
	// ************ PARAMETERS ************
	
	PARAMETER
	{
		name = vesselGroupLaunch
		type = VesselParameterGroup
		title = Put the Crew Module in Orbit
		notes = This module must include at least 2 Docking Port, have support for at least 6 crew, and can generate power.
		define = @/craft
		defineList = AdvancedEarthStations
		
		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = Launch a New Station
			hideChildren = true
		}
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 6
			title = Space for at least 6 crew
			hideChildren = true
		}
		PARAMETER
		{
			name = DockingPort
			type = PartValidation
			partModule = ModuleDockingNode
			minCount = 2
			title = Have at least 2 Docking Ports
			hideChildren = true
		}
		PARAMETER
		{
			name = HasPower
			title = Have a positive energy balance
			type = RP1FixedResourceConsumption
			resource = ElectricCharge
			minRate = -1.0
		}
		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 400000
			maxApA = 500000
			targetBody = HomeWorld()
			title = Reach Orbit with a Perigee greater than 400 km and an Apogee less than 500 km
			hideChildren = true
		}
		PARAMETER
		{
			name = CapsuleType
			type = VesselIsType
			vesselType = Station
			title = Must be a Station
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = AdditionalModules
		type = All
		title = List of station modules that need to launch and rendezvous with the Crew module in orbit. Can be done in any order.
		completeInSequence = true
		
		PARAMETER
		{
			name = vesselGroupLaunch
			type = VesselParameterGroup
			title = Electricity and Heat Management Module
			notes = This module must include at least 2 docking ports, and can generate at least 100 kW of power.
			define = ECModule
			
			PARAMETER
			{
				name = NewVessel
				type = NewVessel
				title = Launch a new module
				hideChildren = true
			}
			PARAMETER
			{
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				title = Uncrewed
				hideChildren = true
			}
			PARAMETER
			{
				name = DockingPort
				type = PartValidation
				partModule = ModuleDockingNode
				minCount = 2
				title = Have at least 2 Docking Ports
				hideChildren = true
			}
			PARAMETER
			{
				name = HasPower
				title = Produce a substantial amount of EC
				type = RP1FixedResourceConsumption
				notes = Produce at least 100 kW of power
				resource = ElectricCharge
				minRate = -100.0
			}
			PARAMETER
			{
				name = Rendezvous
				type = Rendezvous
				vessel = @/craft
				distance = 100
				title = Rendezvous with the station and dock.
			}
			
		}
		
		PARAMETER
		{
			name = vesselGroupLaunch
			type = VesselParameterGroup
			title = Life Support Storage Module
			notes = This module must include at least 2 Docking Port, and enough Life Support to last 6 Crew for 30 Days.
			define = lifeSupportModule
			
			PARAMETER
			{
				name = NewVessel
				type = NewVessel
				title = Launch a new module
				hideChildren = true
			}
			PARAMETER
			{
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				title = Uncrewed
				hideChildren = true
			}
			PARAMETER
			{
				name = DockingPort
				type = PartValidation
				partModule = ModuleDockingNode
				minCount = 2
				title = Have at least 2 Docking Ports
				hideChildren = true
			}
			PARAMETER
			{
				name = HasLifeSupportCapacity
				type = HasResourceCapacity
				title = Have Capacity for Life Support //6 crew, 60d
				
				RESOURCE
				{
					resource = Food
					minQuantity = 2106
				}
				RESOURCE
				{
					resource = Water
					minQuantity = 1394
				}
				RESOURCE
				{
					resource = Oxygen
					minQuantity = 213063
				}
				RESOURCE
				{
					resource = Waste
					minQuantity = 192
				}
				RESOURCE
				{
					resource = WasteWater
					minQuantity = 1773
				}
			}
			PARAMETER
			{
				name = HasLifeSupport
				type = HasResource
				title = Have Life Support Supplies //6crew, 30d
				
				RESOURCE
				{
					resource = Food
					minQuantity = 1053
				}
				RESOURCE
				{
					resource = Water
					minQuantity = 697
				}
				RESOURCE
				{
					resource = Oxygen
					minQuantity = 106532
				}
				
			}
			PARAMETER
			{
				name = Rendezvous
				type = Rendezvous
				vessel = @/craft
				distance = 100
				title = Rendezvous with the station and dock.
			}
		}
		PARAMETER
		{
			name = vesselGroupLaunch
			type = VesselParameterGroup
			title = Docking Module
			notes = This module must have at least 6 docking ports.
			define = dockingModule
			
			PARAMETER
			{
				name = NewVessel
				type = NewVessel
				title = Launch a new module
				hideChildren = true
			}
			PARAMETER
			{
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				title = Uncrewed
				hideChildren = true
			}
			PARAMETER
			{
				name = DockingPort
				type = PartValidation
				partModule = ModuleDockingNode
				minCount = 6
				title = Have at least 6 Docking Ports
				hideChildren = true
			}
			PARAMETER
			{
				name = Rendezvous
				type = Rendezvous
				vessel = @/craft
				distance = 100
				title = Rendezvous with the station and dock.
			}
		}
		
		PARAMETER
		{
			name = vesselGroupLaunch
			type = VesselParameterGroup
			title = Science Experiments Module
			notes = This module must include at least 2 Docking Port, a Science Lab, and 3 Science Experiments
			define = sciModule
			
			PARAMETER
			{
				name = NewVessel
				type = NewVessel
				title = Launch a new module
				hideChildren = true
			}
			PARAMETER
			{
				name = Crewmembers
				type = HasCrew
				minCrew = 0
				maxCrew = 0
				title = Uncrewed
				hideChildren = true
			}
			PARAMETER
			{
				name = DockingPort
				type = PartValidation
				partModule = ModuleDockingNode
				minCount = 2
				title = Have at least 2 Docking Ports
				hideChildren = true
			}
			PARAMETER
			{
				name = HasScienceExperiments
				type = PartValidation
				partModule = ModuleScienceExperiment
				minCount = 3
				title = Has at least 3 science experiments
				hideChildren = true
			}
			PARAMETER
			{
				name = HasScienceLab
				type = PartValidation
				partModule = ModuleScienceLab
				minCount = 1
				title = Has a Science Lab
				hideChildren = true
			}
			PARAMETER
			{
				name = Rendezvous
				type = RP1Rendezvous
				vessel = modularSpaceStation
				distance = 100
				relativeSpeed = 0.5
			}
		}
		
		
	}
	PARAMETER
	{
		name = vesselGroupCrew
		type = VesselParameterGroup
		title = Bring at least 5 crew to the station
		define = crewCapsule

		completeInSequence = true
		
		PARAMETER
		{
			name = NewVessel
			type = NewVessel
			title = Launch a Crew Capsule
			hideChildren = true
		}
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 5
			title = Have at least 5 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = Rendezvous
			type = Rendezvous
			vessel = @/craft
			distance = 100
			title = Rendezvous with the station and dock.
		}
	}
	PARAMETER
	{
		name = stayOnStation
		type = VesselParameterGroup
		title = Keep at least 5 crew aboard the station for 30 days.
		vessel = @/craft

		completeInSequence = true

		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 5
			title = Have at least 5 crewmembers on board
			hideChildren = true
			completeInSequence = true
		}
		PARAMETER
		{
			name = Orbit
			type = Orbit
			minPeA = 400000
			maxApA = 500000
			targetBody = HomeWorld()
			disableOnStateChange = true
			title = Remain in a Stable Orbit
			completeInSequence = true
		}
		PARAMETER
		{
			name = Duration
			type = Duration
			title = Crew station for 30 days
			duration =  30d
			preWaitText = Transfer to the station in the specified orbit.
			waitingText = Orbiting...
			completionText = Stay completed, you may return home now.
			completeInSequence = true
		}	
	}
	PARAMETER
	{
		name = vesselGroupCrewReturn
		type = VesselParameterGroup
		title = Return the crew home
		vessel = crewCapsule

		completeInSequence = true

		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 2
			title = Have at least 2 crewmembers on board
			hideChildren = true
		}
		PARAMETER
		{
			name = ReturnHome
			type = RP1ReturnHome
			title = Return Home Safely
			hideChildren = true
			completeInSequence = true
		}
	}
}